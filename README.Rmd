---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# rChEA3

![Maintainer](https://img.shields.io/badge/maintainer-ckntav-blue)
![Last commit](https://img.shields.io/github/last-commit/ckntav/rChEA3)
![CRAN status](https://www.r-pkg.org/badges/version/rChEA3)
![CRAN downloads](https://cranlogs.r-pkg.org/badges/grand-total/rChEA3)

**An R client for the [ChEA3](https://maayanlab.cloud/chea3/) transcription factor enrichment API.**

While ChEA3 is only available online as a web server, rChEA3 provides access to this tool directly in R, streamlining transcription factor enrichment into your workflow. Submit gene lists, retrieve TF rankings from multiple evidence sources (ChIP-seq, co-expression, literature), and integrate results into your R/Bioconductor analysis pipeline.

The package includes convenient functions to query the API, retrieve results across collections, prepare outputs for downstream analysis, and generate publication-ready figures.

<p align="center"><img src="man/figures/20250925_graphical_abstract_rChEA3_v1.png" width="800"/></p>

## Installation

### From CRAN (stable version)
```{r, install-stable, eval=FALSE}
install.packages("rChEA3")
```

### From GitHub (development version)

You can install the development version of rChEA3 from [GitHub](https://github.com/) with:

```{r, install-dvpt, eval=FALSE}
# install.packages("pak")  # if not already installed
pak::pak("ckntav/rChEA3")

# or, alternatively:
# install.packages("devtools")  # if not already installed
devtools::install_github("ckntav/rChEA3")
```

## Quick start

This quick example demonstrates how to conveniently interrogate the ChEA3 tool.

```{r, load_library}
library(rChEA3)
```

### 1. Query ChEA3

```{r, query1}
my_gene_list <- c("KLK3", "AR", "FKBP5", "TMPRSS2", "KLK2", "CYP1B1")
```
The gene list should consist of [HGNC](https://www.genenames.org)-approved gene symbols, as ChEA3 only accepts these standardized gene identifiers.

```{r, query2}
results <- queryChEA3(my_gene_list)
```
This function sends the query gene list to the ChEA3 web server and performs the transcription factor enrichment analysis.

Once the analysis is complete, the available results from different collections are displayed.

> **Note:** For detailed information about the different ChEA3 collections and their underlying methodology, see [Keenan et al., 2019](https://doi.org/10.1093/nar/gkz446).


### 2. Inspect top results

The function displayTopN() allows quick inspection of the results by showing the top-ranked transcription factors from each collection.
By default, the top 10 transcription factors are displayed for every collection, without applying any threshold on score, p-value, or FDR.

```{r, inspect}
displayTopN(results)
```

### 3. Extract results from a specific collection

The function queryChEA3() returns a list of data frames, one for each ChEA3 collection.
Each element of the list contains transcription factors (TFs) with their associated statistics (rank, score, p-value, or FDR depending on the collection).

To access a specific result table, use the variable storing the results and specify the corresponding collection name. These tables can be indexed by name, explored, filtered, and integrated into downstream R/Bioconductor analyses.

As an example, the Mean Rank integrated results can be retrieved with:

```{r, extract}
meanRank_results <- results[["Integrated--meanRank"]]
head(meanRank_results)
```

This table contains the averaged ranks of transcription factors across all ChEA3 libraries, providing a global view of TF enrichment for your gene set.

### 4. Visualize results

The function visualizeRank() creates a bar plot of the top-ranked transcription factors from a result table.
By default, the plot displays the most significant TFs in descending order, making it easy to quickly identify the strongest candidates for your gene list.

```{r visualize, fig.width=7, fig.height=5, dpi=300}
visualizeRank(meanRank_results)
```

## Contributing

Pull requests are welcome. If you find a bug, have a suggestion, or want to
add a feature, please open an issue first to discuss what you would like
to change.

## Citation
If you use this package, please cite:

Keenan, A.B., Torre, D., Lachmann, A., Leong, A.K., Wojciechowicz, M.L., Utti, V., Jagodnik, K.M., Kropiwnicki, E., Wang, Z., & Ma'ayan, A. (2019). ChEA3: transcription factor enrichment analysis by orthogonal omics integration. *Nucleic Acids Research*, 47(W1), W212â€“W224. [doi:10.1093/nar/gkz446](https://doi.org/10.1093/nar/gkz446)

## Resources
- [ChEA3 web server](https://maayanlab.cloud/chea3/) - For detailed information about collections and methodology
- [Original Publication](https://doi.org/10.1093/nar/gkz446) - ChEA3 paper in Nucleic Acids Research
